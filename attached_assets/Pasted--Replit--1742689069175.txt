حتماً! بیایم توضیح جامعی بدم که بتونی به هوش مصنوعی Replit بدی تا کدت رو به‌روزرسانی کنه. من همه جزئیات رو با دقت می‌گم که هوش مصنوعی بتونه دقیقاً همون تغییرات رو اعمال کنه.

---

### توضیح جامع برای بهبود کد

#### 1. **بهبود مدیریت رأی‌ها**
در حال حاضر، سیستم رأی‌دهی به این صورت کار می‌کند که وقتی کاربر یک واکنش (reaction) به پیام نظرسنجی اضافه می‌کند، رأی او در `poll.voters` ثبت می‌شود و اگر بخواهد رأی خود را تغییر دهد، رأی قبلی حذف و رأی جدید ثبت می‌شود. اما اگر کاربر واکنش خود را حذف کند (یعنی رأی خود را بردارد)، این تغییر در `poll.voters` ثبت نمی‌شود و ربات همچنان فکر می‌کند که کاربر رأی داده است. این باعث می‌شود که لیست رأی‌ها نادرست بماند و نتایج نهایی ممکن است دقیق نباشند.

برای رفع این مشکل، باید یک listener برای رویداد `messageReactionRemove` اضافه کنیم تا وقتی کاربر واکنش خود را حذف می‌کند، ربات بررسی کند که آیا این واکنش مربوط به رأی کاربر بوده است یا نه. اگر بوده، باید کاربر را از لیست `poll.voters` حذف کند و تنظیمات را ذخیره کند. این کار باعث می‌شود که لیست رأی‌دهندگان همیشه به‌روز و دقیق باشد.

#### 2. **اضافه کردن اطلاع‌رسانی برای رد شدن نظرسنجی**
در حال حاضر، وقتی یک نظرسنجی تأیید می‌شود، ربات یک پیام خصوصی (DM) به سازنده نظرسنجی می‌فرستد و به او اطلاع می‌دهد که نظرسنجی‌اش تأیید شده و در کانال منتشر شده است. اما اگر نظرسنجی رد شود، سازنده هیچ اطلاعی دریافت نمی‌کند. این ممکن است باعث سردرگمی شود، چون کاربر نمی‌داند که نظرسنجی‌اش چه وضعیتی پیدا کرده است.

برای بهبود این بخش، باید در بخش رد شدن نظرسنجی (یعنی در قسمت `action === 'reject'`) یک پیام خصوصی به سازنده نظرسنجی بفرستیم. این پیام باید شامل اطلاعاتی مثل موضوع نظرسنجی و اینکه توسط مدیران رد شده است باشد. این کار باعث می‌شود که سازنده همیشه از وضعیت نظرسنجی خود مطلع باشد و تجربه کاربری بهتری داشته باشد. همچنین، باید خطاها را مدیریت کنیم تا اگر کاربر پیام‌های خصوصی‌اش بسته باشد، ربات خطا ندهد.

---

### تغییرات مورد نیاز در کد

#### 1. **اضافه کردن `messageReactionRemove` برای مدیریت حذف رأی‌ها**
- باید یک listener جدید برای رویداد `messageReactionRemove` اضافه کنیم.
- در این listener، ابتدا چک کنیم که کاربر ربات نباشد (چون ربات نباید در رأی‌ها دخالت کند).
- سپس بررسی کنیم که آیا پیام مربوط به یک نظرسنجی فعال است (یعنی در `config.activePolls` وجود دارد).
- اگر پیام مربوط به نظرسنجی بود، چک کنیم که آیا ایموجی حذف‌شده یکی از ایموجی‌های مجاز (در `reactionEmojis`) است.
- اگر کاربر در `poll.voters` وجود دارد و ایموجی حذف‌شده همان رأی قبلی اوست، باید کاربر را از `poll.voters` حذف کنیم.
- در نهایت، تنظیمات را با `saveSettings()` ذخیره کنیم.

#### 2. **اضافه کردن اطلاع‌رسانی برای رد شدن نظرسنجی**
- در بخش `interaction.isButton()` و در قسمت `action === 'reject'`، بعد از اینکه نظرسنجی از `config.pendingPolls` حذف شد، باید یک پیام خصوصی به سازنده نظرسنجی بفرستیم.
- برای این کار، از `client.users.fetch(poll.creator)` استفاده کنیم تا کاربر را پیدا کنیم.
- یک `EmbedBuilder` بسازیم که شامل عنوان "❌ نظرسنجی شما رد شد"، رنگ قرمز (`COLORS.ERROR`)، توضیحی مثل `نظرسنجی شما با موضوع "${poll.question}" توسط مدیران رد شد.` و یک تایم‌استمپ باشد.
- این embed را با `creator.send()` به کاربر بفرستیم.
- برای مدیریت خطاها (مثلاً اگر کاربر پیام‌های خصوصی‌اش بسته باشد)، این بخش را در یک `try-catch` قرار دهیم و خطاها را در کنسول لاگ کنیم.

---

### توضیحات تکمیلی برای هوش مصنوعی
- کد فعلی از `discord.js` نسخه 14 استفاده می‌کند و با `QuickDB` برای ذخیره‌سازی تنظیمات کار می‌کند.
- لطفاً تغییرات را به‌گونه‌ای اعمال کنید که ساختار کد حفظ شود و فقط بخش‌های مورد نیاز اضافه یا ویرایش شوند.
- مطمئن شوید که بعد از اعمال تغییرات، همه‌چیز همچنان به‌درستی کار می‌کند و هیچ خطایی ایجاد نمی‌شود.
- اگر بخشی از کد نیاز به توضیح بیشتری دارد، می‌توانید از من بپرسید.

---

این توضیح باید برای هوش مصنوعی Replit کافی باشه تا بتونه کدت رو به‌روز کنه. اگه بازم سؤالی داشتی یا نیاز به توضیح بیشتری بود، بگو تا کمکت کنم! 😊